<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Expense Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 5px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .tab-btn {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            border-bottom-color: #27ae60;
            background-color: #f8f9fa;
        }

        .tab-btn:hover {
            background-color: #f8f9fa;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 25px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #27ae60;
            outline: none;
        }

        .btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px 5px 5px 0;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background: #229954;
        }

        .btn-danger {
            background: #e74c3c;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-warning {
            background: #f39c12;
        }

        .btn-warning:hover {
            background: #e67e22;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 5px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .summary-card.income {
            border-left: 4px solid #27ae60;
        }

        .summary-card.expense {
            border-left: 4px solid #e74c3c;
        }

        .summary-card.balance {
            border-left: 4px solid #3498db;
        }

        .summary-amount {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .summary-label {
            color: #7f8c8d;
            font-size: 14px;
        }

        .amount-positive {
            color: #27ae60;
        }

        .amount-negative {
            color: #e74c3c;
        }

        .transaction-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid #ddd;
        }

        .transaction-item.income {
            border-left-color: #27ae60;
        }

        .transaction-item.expense {
            border-left-color: #e74c3c;
        }

        .transaction-details {
            flex-grow: 1;
        }

        .transaction-description {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .transaction-meta {
            font-size: 12px;
            color: #7f8c8d;
        }

        .transaction-amount {
            font-size: 18px;
            font-weight: bold;
            margin-left: 15px;
        }

        .transaction-actions {
            margin-left: 15px;
        }

        .category-tag {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            margin-right: 5px;
        }

        .filter-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            align-items: end;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            color: #5d6d7e;
        }

        .category-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid #3498db;
        }

        .category-info {
            flex-grow: 1;
        }

        .category-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .category-total {
            font-size: 12px;
            color: #7f8c8d;
        }

        .category-amount {
            font-size: 16px;
            font-weight: bold;
            color: #2c3e50;
        }

        .date-filter {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
        }

        .date-filter select,
        .date-filter input {
            flex: 1;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .stats-card {
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .stats-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 5px;
        }

        .stats-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 5px;
            border-bottom: 1px solid #ecf0f1;
        }

        .stats-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .filter-row {
                grid-template-columns: 1fr;
            }
            
            .transaction-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .transaction-amount,
            .transaction-actions {
                margin-left: 0;
                margin-top: 10px;
            }
            
            .date-filter {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Personal Expense Tracker</h1>
            <p>Track your income and expenses to manage your finances</p>
        </div>

        <!-- Summary Cards -->
        <div class="summary-cards">
            <div class="summary-card income">
                <div class="summary-amount amount-positive" id="totalIncome">₹0.00</div>
                <div class="summary-label">Total Income</div>
            </div>
            <div class="summary-card expense">
                <div class="summary-amount amount-negative" id="totalExpense">₹0.00</div>
                <div class="summary-label">Total Expenses</div>
            </div>
            <div class="summary-card balance">
                <div class="summary-amount" id="totalBalance">₹0.00</div>
                <div class="summary-label">Net Balance</div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('add-transaction')">Add Transaction</button>
            <button class="tab-btn" onclick="showTab('transactions')">Transactions</button>
            <button class="tab-btn" onclick="showTab('categories')">Categories</button>
            <button class="tab-btn" onclick="showTab('reports')">Reports</button>
        </div>

        <!-- Add Transaction Tab -->
        <div id="add-transaction" class="tab-content active">
            <h2>Add New Transaction</h2>
            
            <div class="form-group">
                <label for="transactionType">Type</label>
                <select id="transactionType">
                    <option value="expense">Expense</option>
                    <option value="income">Income</option>
                </select>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="transactionAmount">Amount</label>
                    <input type="number" id="transactionAmount" step="0.01" placeholder="0.00" required>
                </div>
                <div class="form-group">
                    <label for="transactionDate">Date</label>
                    <input type="date" id="transactionDate" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="transactionCategory">Category</label>
                    <select id="transactionCategory">
                        <option value="">Select Category</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newCategory">Or Add New Category</label>
                    <input type="text" id="newCategory" placeholder="Enter new category">
                </div>
            </div>

            <div class="form-group">
                <label for="transactionDescription">Description</label>
                <input type="text" id="transactionDescription" placeholder="Enter description" required>
            </div>

            <div class="form-group">
                <label for="transactionNotes">Notes (Optional)</label>
                <textarea id="transactionNotes" rows="3" placeholder="Additional notes..."></textarea>
            </div>

            <button class="btn" onclick="addTransaction()">Add Transaction</button>
        </div>

        <!-- Transactions Tab -->
        <div id="transactions" class="tab-content">
            <h2>Transaction History</h2>
            
            <div class="filter-section">
                <div class="filter-row">
                    <div>
                        <label>Filter by Type</label>
                        <select id="filterType" onchange="filterTransactions()">
                            <option value="all">All Transactions</option>
                            <option value="income">Income Only</option>
                            <option value="expense">Expenses Only</option>
                        </select>
                    </div>
                    <div>
                        <label>Filter by Category</label>
                        <select id="filterCategory" onchange="filterTransactions()">
                            <option value="all">All Categories</option>
                        </select>
                    </div>
                    <div>
                        <label>Sort by</label>
                        <select id="sortBy" onchange="filterTransactions()">
                            <option value="date-desc">Newest First</option>
                            <option value="date-asc">Oldest First</option>
                            <option value="amount-desc">Highest Amount</option>
                            <option value="amount-asc">Lowest Amount</option>
                        </select>
                    </div>
                    <div>
                        <button class="btn" onclick="clearFilters()">Clear Filters</button>
                    </div>
                </div>
            </div>

            <div id="transactionsList">
                <!-- Transactions will be displayed here -->
            </div>
        </div>

        <!-- Categories Tab -->
        <div id="categories" class="tab-content">
            <h2>Manage Categories</h2>
            
            <div class="form-group">
                <label for="categoryName">Category Name</label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="categoryName" placeholder="Enter category name">
                    <button class="btn" onclick="addCategory()">Add Category</button>
                </div>
            </div>

            <div id="categoriesList">
                <!-- Categories will be displayed here -->
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <h2>Financial Reports</h2>
            
            <div class="date-filter">
                <label>Report Period:</label>
                <select id="reportPeriod" onchange="updateReports()">
                    <option value="this-month">This Month</option>
                    <option value="last-month">Last Month</option>
                    <option value="this-year">This Year</option>
                    <option value="last-year">Last Year</option>
                    <option value="custom">Custom Range</option>
                </select>
                <input type="date" id="startDate" onchange="updateReports()" style="display: none;">
                <input type="date" id="endDate" onchange="updateReports()" style="display: none;">
            </div>

            <div class="stats-grid">
                <div class="stats-card">
                    <div class="stats-title">Expense Categories</div>
                    <div id="expenseCategoriesReport">
                        <!-- Category breakdown will be displayed here -->
                    </div>
                </div>

                <div class="stats-card">
                    <div class="stats-title">Income Sources</div>
                    <div id="incomeCategoriesReport">
                        <!-- Income breakdown will be displayed here -->
                    </div>
                </div>

                <div class="stats-card">
                    <div class="stats-title">Monthly Summary</div>
                    <div id="monthlySummary">
                        <!-- Monthly summary will be displayed here -->
                    </div>
                </div>

                <div class="stats-card">
                    <div class="stats-title">Recent Activity</div>
                    <div id="recentActivity">
                        <!-- Recent transactions will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let transactions = [];
        let categories = ['Food', 'Transportation', 'Entertainment', 'Bills', 'Shopping', 'Health', 'Education', 'Salary', 'Freelance', 'Investment'];
        let filteredTransactions = [];

        // Initialize app
        window.onload = function() {
            // Set today's date as default
            document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
            
            updateCategoryDropdowns();
            updateSummary();
            displayTransactions();
            displayCategories();
            updateReports();
        };

        // Tab switching
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'reports') {
                updateReports();
            }
        }

        // Add new transaction
        function addTransaction() {
            const type = document.getElementById('transactionType').value;
            const amount = parseFloat(document.getElementById('transactionAmount').value);
            const date = document.getElementById('transactionDate').value;
            const description = document.getElementById('transactionDescription').value.trim();
            const notes = document.getElementById('transactionNotes').value.trim();
            const newCategory = document.getElementById('newCategory').value.trim();
            let category = document.getElementById('transactionCategory').value;

            if (!amount || !date || !description) {
                alert('Please fill in all required fields');
                return;
            }

            if (amount <= 0) {
                alert('Amount must be greater than 0');
                return;
            }

            // Handle new category
            if (newCategory && !category) {
                category = newCategory;
                if (!categories.includes(category)) {
                    categories.push(category);
                    updateCategoryDropdowns();
                }
            } else if (!category) {
                alert('Please select or enter a category');
                return;
            }

            const transaction = {
                id: Date.now(),
                type: type,
                amount: amount,
                date: date,
                category: category,
                description: description,
                notes: notes,
                createdAt: new Date()
            };

            transactions.push(transaction);

            // Clear form
            document.getElementById('transactionAmount').value = '';
            document.getElementById('transactionDescription').value = '';
            document.getElementById('transactionNotes').value = '';
            document.getElementById('transactionCategory').value = '';
            document.getElementById('newCategory').value = '';

            updateSummary();
            displayTransactions();
            updateReports();

            alert('Transaction added successfully!');
        }

        // Update financial summary
        function updateSummary() {
            const totalIncome = transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);

            const totalExpense = transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);

            const balance = totalIncome - totalExpense;

            document.getElementById('totalIncome').textContent = '₹' + totalIncome.toFixed(2);
            document.getElementById('totalExpense').textContent = '₹' + totalExpense.toFixed(2);
            document.getElementById('totalBalance').textContent = '₹' + balance.toFixed(2);

            // Update balance color
            const balanceElement = document.getElementById('totalBalance');
            balanceElement.className = 'summary-amount ' + (balance >= 0 ? 'amount-positive' : 'amount-negative');
        }

        // Display transactions
        function displayTransactions() {
            const container = document.getElementById('transactionsList');
            const transactionsToShow = filteredTransactions.length > 0 ? filteredTransactions : transactions;

            if (transactionsToShow.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>No transactions found</h3>
                        <p>Add your first transaction to get started!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = transactionsToShow.map(transaction => `
                <div class="transaction-item ${transaction.type}">
                    <div class="transaction-details">
                        <div class="transaction-description">${transaction.description}</div>
                        <div class="transaction-meta">
                            <span class="category-tag">${transaction.category}</span>
                            ${transaction.date} ${transaction.notes ? '• ' + transaction.notes : ''}
                        </div>
                    </div>
                    <div class="transaction-amount ${transaction.type === 'income' ? 'amount-positive' : 'amount-negative'}">
                        ${transaction.type === 'income' ? '+' : '-'}₹${transaction.amount.toFixed(2)}
                    </div>
                    <div class="transaction-actions">
                        <button class="btn btn-warning" onclick="editTransaction(${transaction.id})">Edit</button>
                        <button class="btn btn-danger" onclick="deleteTransaction(${transaction.id})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Filter transactions
        function filterTransactions() {
            const typeFilter = document.getElementById('filterType').value;
            const categoryFilter = document.getElementById('filterCategory').value;
            const sortBy = document.getElementById('sortBy').value;

            filteredTransactions = [...transactions];

            // Apply filters
            if (typeFilter !== 'all') {
                filteredTransactions = filteredTransactions.filter(t => t.type === typeFilter);
            }

            if (categoryFilter !== 'all') {
                filteredTransactions = filteredTransactions.filter(t => t.category === categoryFilter);
            }

            // Apply sorting
            filteredTransactions.sort((a, b) => {
                switch (sortBy) {
                    case 'date-desc':
                        return new Date(b.date) - new Date(a.date);
                    case 'date-asc':
                        return new Date(a.date) - new Date(b.date);
                    case 'amount-desc':
                        return b.amount - a.amount;
                    case 'amount-asc':
                        return a.amount - b.amount;
                    default:
                        return new Date(b.date) - new Date(a.date);
                }
            });

            displayTransactions();
        }

        // Clear filters
        function clearFilters() {
            document.getElementById('filterType').value = 'all';
            document.getElementById('filterCategory').value = 'all';
            document.getElementById('sortBy').value = 'date-desc';
            filteredTransactions = [];
            displayTransactions();
        }

        // Delete transaction
        function deleteTransaction(id) {
            if (confirm('Are you sure you want to delete this transaction?')) {
                transactions = transactions.filter(t => t.id !== id);
                updateSummary();
                displayTransactions();
                updateReports();
            }
        }

        // Edit transaction (simplified - just delete and re-add)
        function editTransaction(id) {
            const transaction = transactions.find(t => t.id === id);
            if (transaction) {
                // Fill form with existing data
                document.getElementById('transactionType').value = transaction.type;
                document.getElementById('transactionAmount').value = transaction.amount;
                document.getElementById('transactionDate').value = transaction.date;
                document.getElementById('transactionCategory').value = transaction.category;
                document.getElementById('transactionDescription').value = transaction.description;
                document.getElementById('transactionNotes').value = transaction.notes || '';

                // Delete the transaction
                deleteTransaction(id);

                // Switch to add transaction tab
                showTab('add-transaction');
                document.querySelector('[onclick="showTab(\'add-transaction\')"]').classList.add('active');
            }
        }

        // Add new category
        function addCategory() {
            const categoryName = document.getElementById('categoryName').value.trim();
            
            if (!categoryName) {
                alert('Please enter a category name');
                return;
            }

            if (categories.includes(categoryName)) {
                alert('Category already exists');
                return;
            }

            categories.push(categoryName);
            document.getElementById('categoryName').value = '';
            updateCategoryDropdowns();
            displayCategories();
        }

        // Update category dropdowns
        function updateCategoryDropdowns() {
            const transactionCategorySelect = document.getElementById('transactionCategory');
            const filterCategorySelect = document.getElementById('filterCategory');

            // Update transaction form dropdown
            transactionCategorySelect.innerHTML = '<option value="">Select Category</option>' +
                categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');

            // Update filter dropdown
            filterCategorySelect.innerHTML = '<option value="all">All Categories</option>' +
                categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
        }

        // Display categories
        function displayCategories() {
            const container = document.getElementById('categoriesList');

            if (categories.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>No categories</h3>
                        <p>Add your first category above!</p>
                    </div>
                `;
                return;
            }

            // Calculate totals for each category
            const categoryTotals = {};
            categories.forEach(cat => {
                categoryTotals[cat] = {
                    total: 0,
                    count: 0
                };
            });

            transactions.forEach(t => {
                if (categoryTotals[t.category]) {
                    categoryTotals[t.category].total += t.amount;
                    categoryTotals[t.category].count += 1;
                }
            });

            container.innerHTML = categories.map(category => `
                <div class="category-item">
                    <div class="category-info">
                        <div class="category-name">${category}</div>
                        <div class="category-total">${categoryTotals[category].count} transactions</div>
                    </div>
                    <div class="category-amount">₹${categoryTotals[category].total.toFixed(2)}</div>
                    <button class="btn btn-danger" onclick="deleteCategory('${category}')">Delete</button>
                </div>
            `).join('');
        }

        // Delete category
        function deleteCategory(categoryName) {
            const hasTransactions = transactions.some(t => t.category === categoryName);
            
            if (hasTransactions) {
                alert('Cannot delete category with existing transactions');
                return;
            }

            if (confirm('Are you sure you want to delete this category?')) {
                categories = categories.filter(c => c !== categoryName);
                updateCategoryDropdowns();
                displayCategories();
            }
        }

        // Update reports
        function updateReports() {
            const reportPeriod = document.getElementById('reportPeriod').value;
            let startDate, endDate;

            // Handle date range
            if (reportPeriod === 'custom') {
                document.getElementById('startDate').style.display = 'block';
                document.getElementById('endDate').style.display = 'block';
                startDate = document.getElementById('startDate').value;
                endDate = document.getElementById('endDate').value;
            } else {
                document.getElementById('startDate').style.display = 'none';
                document.getElementById('endDate').style.display = 'none';
                
                const now = new Date();
                switch (reportPeriod) {
                    case 'this-month':
                        startDate = new Date(now.getFullYear(), now.getMonth(), 1).toISOString().split('T')[0];
                        endDate = new Date(now.getFullYear(), now.getMonth() + 1, 0).toISOString().split('T')[0];
                        break;
                    case 'last-month':
                        startDate = new Date(now.getFullYear(), now.getMonth() - 1, 1).toISOString().split('T')[0];
                        endDate = new Date(now.getFullYear(), now.getMonth(), 0).toISOString().split('T')[0];
                        break;
                    case 'this-year':
                        startDate = new Date(now.getFullYear(), 0, 1).toISOString().split('T')[0];
                        endDate = new Date(now.getFullYear(), 11, 31).toISOString().split('T')[0];
                        break;
                    case 'last-year':
                        startDate = new Date(now.getFullYear() - 1, 0, 1).toISOString().split('T')[0];
                        endDate = new Date(now.getFullYear() - 1, 11, 31).toISOString().split('T')[0];
                        break;
                }
            }

            // Filter transactions by date range
            let reportTransactions = transactions;
            if (startDate && endDate) {
                reportTransactions = transactions.filter(t => t.date >= startDate && t.date <= endDate);
            }

            // Generate reports
            generateExpenseCategoriesReport(reportTransactions);
            generateIncomeCategoriesReport(reportTransactions);
            generateMonthlySummary(reportTransactions);
            generateRecentActivity(reportTransactions);
        }

        // Generate expense categories report
        function generateExpenseCategoriesReport(transactions) {
            const container = document.getElementById('expenseCategoriesReport');
            const expenseTransactions = transactions.filter(t => t.type === 'expense');
            
            if (expenseTransactions.length === 0) {
                container.innerHTML = '<p>No expense data for this period</p>';
                return;
            }

            const categoryTotals = {};
            expenseTransactions.forEach(t => {
                categoryTotals[t.category] = (categoryTotals[t.category] || 0) + t.amount;
            });

            container.innerHTML = Object.keys(categoryTotals).map(cat => `
                <div class="stats-item">
                    <div>${cat}</div>
                    <div>₹${categoryTotals[cat].toFixed(2)}</div>
                </div>
            `).join('');
        }

        // Generate income categories report
        function generateIncomeCategoriesReport(transactions) {
            const container = document.getElementById('incomeCategoriesReport');
            const incomeTransactions = transactions.filter(t => t.type === 'income');
            
            if (incomeTransactions.length === 0) {
                container.innerHTML = '<p>No income data for this period</p>';
                return;
            }

            const categoryTotals = {};
            incomeTransactions.forEach(t => {
                categoryTotals[t.category] = (categoryTotals[t.category] || 0) + t.amount;
            });

            container.innerHTML = Object.keys(categoryTotals).map(cat => `
                <div class="stats-item">
                    <div>${cat}</div>
                    <div>₹${categoryTotals[cat].toFixed(2)}</div>
                </div>
            `).join('');
        }

        // Generate monthly summary report
        function generateMonthlySummary(transactions) {
            const container = document.getElementById('monthlySummary');
            const monthlySummary = {};

            transactions.forEach(t => {
                const month = new Date(t.date).toLocaleString('default', { month: 'long', year: 'numeric' });
                if (!monthlySummary[month]) {
                    monthlySummary[month] = { income: 0, expense: 0 };
                }
                monthlySummary[month][t.type] += t.amount;
            });

            const sortedMonths = Object.keys(monthlySummary).sort((a, b) => new Date(b) - new Date(a));

            container.innerHTML = sortedMonths.map(month => {
                const data = monthlySummary[month];
                return `
                    <div class="stats-item">
                        <div>${month}</div>
                        <div>Income: ₹${data.income.toFixed(2)} | Expense: ₹${data.expense.toFixed(2)}</div>
                    </div>
                `;
            }).join('');
        }

        // Generate recent activity report
        function generateRecentActivity(transactions) {
            const container = document.getElementById('recentActivity');

            if (transactions.length === 0) {
                container.innerHTML = '<p>No recent activity</p>';
                return;
            }

            container.innerHTML = transactions.slice(-5).map(t => `
                <div class="transaction-item ${t.type}">
                    <div class="transaction-details">
                        <div class="transaction-description">${t.description}</div>
                        <div class="transaction-meta">
                            <span class="category-tag">${t.category}</span>
                            ${t.date} ${t.notes ? '• ' + t.notes : ''}
                        </div>
                    </div>
                    <div class="transaction-amount ${t.type === 'income' ? 'amount-positive' : 'amount-negative'}">
                        ${t.type === 'income' ? '+' : '-'}₹${t.amount.toFixed(2)}
                    </div>
                </div>
            `).join('');
        }
    </script>
</body>
</html>